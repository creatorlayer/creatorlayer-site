"use strict";
/* ============================================================================
 * Copyright (c) Palo Alto Networks
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 * ========================================================================== */
var __importDefault =
  (this && this.__importDefault) ||
  function (mod) {
    return mod && mod.__esModule ? mod : { default: mod };
  };
Object.defineProperty(exports, "__esModule", { value: true });
const react_1 = __importDefault(require("react"));
const Translate_1 = require("@docusaurus/Translate");
const Example_1 = require("@theme/Example");
const Markdown_1 = __importDefault(require("@theme/Markdown"));
/* eslint-disable import/no-extraneous-dependencies*/
const translationIds_1 = require("@theme/translationIds");
const clsx_1 = __importDefault(require("clsx"));
const schema_1 = require("../../markdown/schema");
const utils_1 = require("../../markdown/utils");
const getEnumDescriptionMarkdown = (enumDescriptions) => {
  if (enumDescriptions?.length) {
    const enumValue = (0, Translate_1.translate)({
      id: translationIds_1.OPENAPI_SCHEMA_ITEM.ENUM_VALUE,
      message: "Enum Value",
    });
    const description = (0, Translate_1.translate)({
      id: translationIds_1.OPENAPI_SCHEMA_ITEM.ENUM_DESCRIPTION,
      message: "Description",
    });
    return `| ${enumValue} | ${description} |
| ---- | ----- |
${enumDescriptions
  .map((desc) => {
    return `| ${desc[0]} | ${desc[1]} | `.replaceAll("\n", "<br/>");
  })
  .join("\n")}
    `;
  }
  return "";
};
function ParamsItem({ param, ...rest }) {
  const { description, name, required, deprecated, enumDescriptions } = param;
  let schema = param.schema;
  let defaultValue;
  let examples = param.examples ?? schema?.examples;
  let example = param.example ?? schema?.example;
  if (!schema) {
    schema = { type: "any" };
  }
  if (!schema.type) {
    schema.type = "any";
  }
  if (schema) {
    if (schema.items) {
      defaultValue = schema.items.default;
    } else {
      defaultValue = schema.default;
    }
  }
  const renderSchemaName = (0, utils_1.guard)(schema, (schema) =>
    react_1.default.createElement(
      "span",
      { className: "openapi-schema__type" },
      " ",
      (0, schema_1.getSchemaName)(schema)
    )
  );
  const renderSchemaRequired = (0, utils_1.guard)(required, () =>
    react_1.default.createElement(
      "span",
      { className: "openapi-schema__required" },
      (0, Translate_1.translate)({
        id: translationIds_1.OPENAPI_SCHEMA_ITEM.REQUIRED,
        message: "required",
      })
    )
  );
  const renderDeprecated = (0, utils_1.guard)(deprecated, () =>
    react_1.default.createElement(
      "span",
      { className: "openapi-schema__deprecated" },
      (0, Translate_1.translate)({
        id: translationIds_1.OPENAPI_SCHEMA_ITEM.DEPRECATED,
        message: "deprecated",
      })
    )
  );
  const renderQualifier = (0, utils_1.guard)(
    (0, schema_1.getQualifierMessage)(schema),
    (qualifier) =>
      react_1.default.createElement(Markdown_1.default, null, qualifier)
  );
  const renderDescription = (0, utils_1.guard)(description, (description) =>
    react_1.default.createElement(Markdown_1.default, null, description)
  );
  const renderEnumDescriptions = (0, utils_1.guard)(
    getEnumDescriptionMarkdown(enumDescriptions),
    (value) => {
      return react_1.default.createElement(
        "div",
        { style: { marginTop: ".5rem" } },
        react_1.default.createElement(Markdown_1.default, null, value)
      );
    }
  );
  function renderDefaultValue() {
    if (defaultValue !== undefined) {
      if (typeof defaultValue === "string") {
        return react_1.default.createElement(
          "div",
          null,
          react_1.default.createElement(
            "strong",
            null,
            (0, Translate_1.translate)({
              id: translationIds_1.OPENAPI_SCHEMA_ITEM.DEFAULT_VALUE,
              message: "Default value:",
            }),
            " "
          ),
          react_1.default.createElement(
            "span",
            null,
            react_1.default.createElement("code", null, defaultValue)
          )
        );
      }
      return react_1.default.createElement(
        "div",
        null,
        react_1.default.createElement(
          "strong",
          null,
          (0, Translate_1.translate)({
            id: translationIds_1.OPENAPI_SCHEMA_ITEM.DEFAULT_VALUE,
            message: "Default value:",
          }),
          " "
        ),
        react_1.default.createElement(
          "span",
          null,
          react_1.default.createElement(
            "code",
            null,
            JSON.stringify(defaultValue)
          )
        )
      );
    }
    return undefined;
  }
  return react_1.default.createElement(
    "div",
    { className: "openapi-params__list-item" },
    react_1.default.createElement(
      "span",
      { className: "openapi-schema__container" },
      react_1.default.createElement(
        "strong",
        {
          className: (0, clsx_1.default)("openapi-schema__property", {
            "openapi-schema__strikethrough": deprecated,
          }),
        },
        name
      ),
      renderSchemaName,
      (required || deprecated) &&
        react_1.default.createElement("span", {
          className: "openapi-schema__divider",
        }),
      renderSchemaRequired,
      renderDeprecated
    ),
    renderQualifier,
    renderDescription,
    renderEnumDescriptions,
    renderDefaultValue(),
    react_1.default.createElement(Example_1.Example, { example: example }),
    react_1.default.createElement(Example_1.Example, { examples: examples })
  );
}
exports.default = ParamsItem;
